<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test - Nuevo Sistema de Formularios</title>
    <link rel="stylesheet" href="../build/form-modules-style.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .test-header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .debug-info {
        margin-top: 30px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 4px;
        font-family: monospace;
        font-size: 12px;
        color: #495057;
      }
    </style>
  </head>
  <body>
    <div class="test-header">
      <h1>Test - Nuevo Sistema de Formularios</h1>
      <p>Prueba de las nuevas funcionalidades con validaci√≥n autom√°tica y adaptadores modernos</p>
    </div>

    <div class="form-container">
      <div class="form-card">
        <form
          class="form-modules"
          id="test-form"
          aria-label="Prueba 1: Configuraci√≥n Base"
          novalidate
        >
          <!-- HEADER: Solo t√≠tulo fijo -->
          <div class="form-header">
            <h2>Formulario de inscripci√≥n</h2>
            <p>Completa el formulario para reservar tu lugar en nuestro evento</p>
          </div>

          <!-- CONTENT: Descripci√≥n + campos + autorizaci√≥n con scroll -->
          <div class="form-content">
            <!-- Nombres y apellidos -->
            <div class="field-group">
              <div class="field">
                <input type="text" placeholder="*Nombre(s)" name="first_name" />
              </div>
              <div class="field">
                <input type="text" placeholder="*Apellidos" name="last_name" />
              </div>
            </div>

            <!-- Tipo de documento y n√∫mero -->
            <div class="field-group">
              <div class="field">
                <select name="type_doc">
                  <option value="">*Tipo de documento</option>
                  <option value="CC">C√©dula Ciudadan√≠a</option>
                  <option value="CE">C√©dula Extranjer√≠a</option>
                  <option value="PA">Pasaporte</option>
                  <option value="TI">Tarjeta Identidad</option>
                </select>
              </div>

              <div class="field">
                <input type="text" name="document" placeholder="*N√∫mero de documento" />
              </div>
            </div>

            <!-- Email -->
            <div class="field">
              <input type="email" placeholder="*Email" name="email" />
            </div>

            <!-- Tel√©fono -->
            <div class="field phone-field-group">
              <div class="field phone-prefix-field">
                <select name="phone_code" class="phone-prefix-select">
                  <option value="">Indicativo</option>
                </select>
              </div>
              <div class="field phone-number-field">
                <input type="text" placeholder="*N√∫mero de tel√©fono" name="mobile" />
              </div>
            </div>

            <!-- Ubicaci√≥n -->
            <div class="field">
              <select name="country" class="country-select">
                <option value="">*Pa√≠s de residencia</option>
              </select>
            </div>

            <div class="field">
              <select name="department" style="display: none">
                <option value="">*Selecciona el departamento</option>
              </select>
            </div>

            <div class="field">
              <select name="city" style="display: none">
                <option value="">*Selecciona la Ciudad</option>
              </select>
            </div>

            <!-- D√≠a de asistencia -->
            <div class="field">
              <select name="attendance_day">
                <option value="">*D√≠a de asistencia</option>
              </select>
            </div>

            <!-- Tipo de asistente -->
            <div class="field">
              <select name="type_attendee">
                <option value="">*Tipo de asistente</option>
              </select>
            </div>

            <!-- Nivel acad√©mico -->
            <div class="field">
              <select name="academic_level" style="display: none">
                <option value="">*Nivel acad√©mico</option>
              </select>
            </div>

            <!-- Facultad -->
            <div class="field">
              <select name="faculty" style="display: none">
                <option value="">*Facultad de inter√©s</option>
              </select>
            </div>

            <!-- Programa -->
            <div class="field">
              <select name="program" style="display: none">
                <option value="">*Programa de inter√©s</option>
              </select>
            </div>

            <!-- Per√≠odo de ingreso -->
            <div class="field">
              <select name="admission_period" style="display: none">
                <option value="">*Periodo esperado de Ingreso de inter√©s</option>
              </select>
            </div>

            <!-- Autorizaci√≥n de datos dentro del scroll -->
            <div class="authorization-section">
              <p>
                ¬øAutorizas el tratamiento de tus datos personales de acuerdo con la
                <a
                  href="https://cloud.cx.javeriana.edu.co/tratamiento_Datos_Javeriana_Eventos.html"
                  target="_blank"
                  >autorizaci√≥n de privacidad</a
                >?
              </p>
              <div class="radio-group">
                <div class="radio-option">
                  <input type="radio" id="auth_si_1" name="authorization_data" value="1" />
                  <label for="auth_si_1">S√≠</label>
                </div>
                <div class="radio-option">
                  <input type="radio" id="auth_no_1" name="authorization_data" value="0" />
                  <label for="auth_no_1">No</label>
                </div>
              </div>
            </div>
          </div>

          <!-- FOOTER: Solo bot√≥n fijo -->
          <div class="form-footer">
            <button type="submit" class="submit-button">Inscr√≠bete</button>
          </div>
        </form>
      </div>

      <!-- Debug Info -->
      <div class="debug-info" id="debug-info">
        <strong>üìä Debug Info:</strong><br />
        <div id="debug-content">Sistema inicializando...</div>
      </div>
    </div>

    <script src="../build/form-modules-script.js"></script>
    <script>
      // Configuraci√≥n del formulario siguiendo las mejores pr√°cticas de examples.js y ConfigLoader.js
      const formConfig = {
        // DATOS DE EVENTO
        eventName: "Test Evento - Nuevo Sistema 2025",
        eventDate: "15/03/2025 10:00 AM",
        campaign: "TEST_NUEVO_SISTEMA_2025",
        article: "evento_test_sistema",
        source: "test-page",
        medium: "web",
        retUrl: "https://cloud.cx.javeriana.edu.co/EVENTOS_TKY",

        // CONFIGURACIONES DE MODO
        test: true,
        debug: true,
        development: false,
        debugEmail: "gavilanm-j@javeriana.edu.co",

        // CAMPOS OCULTOS
        leadSource: "Landing Pages",
        authorizationSource: "Formulario Test",
        requestOrigin: "Test Nuevo Sistema",

        // FILTROS - Ubicaciones (siguiendo patr√≥n de examples.js)
        countries: ["Colombia", "Estados Unidos", "Espa√±a", "M√©xico"],
        departments: [],
        cities: [],

        // DATOS ACAD√âMICOS (siguiendo estructura de ConfigLoader)
        academicLevels: [],
        faculties: [],
        programs: [],

        // DATOS DEL EVENTO
        typeAttendee: [
          "Aspirante",
          "Padre de familia y/o acudiente",
          "Estudiante actual",
          "Egresado",
          "Docente y/o psicoorientador",
        ],
        attendanceDays: [
          "Viernes 15 de marzo de 2025",
          "S√°bado 16 de marzo de 2025",
          "Domingo 17 de marzo de 2025",
        ],

        // CONFIGURACI√ìN DE CACH√â
        cache: {
          enabled: true,
          expirationHours: 12,
        },

        // URLs de datos (siguiendo ConfigLoader)
        urls: {
          locations: "../data/ubicaciones.json",
          prefixes: "../data/prefijos.json",
          programs: "../data/programas.json",
          periods: "../data/periodos.json",
        },

        // URL de pol√≠tica de privacidad
        privacyPolicyUrl:
          "https://cloud.cx.javeriana.edu.co/tratamiento_Datos_Javeriana_Eventos.html",

        // CONFIGURACI√ìN DE LOGGING
        logging: {
          enabled: true,
          level: "debug",
          showTimestamp: true,
          showLevel: true,
          prefix: "#test-form | Test Evento - Nuevo Sistema 2025",
        },

        // CONFIGURACI√ìN DE UI
        ui: {
          errorClass: "error",
          validClass: "validated",
          errorTextClass: "error_text",
          hiddenClass: "fm-hidden",
          animationDuration: 300,
          enableAnimations: true,
          loadingText: "Cargando datos...",
          successText: "¬°Registro exitoso!",
          errorText: "Error al procesar formulario",
        },

        // CALLBACKS
        callbacks: {
          onFormLoad: (formManager) => {
            console.log("üìã Formulario cargado correctamente");
            updateDebugInfo("Formulario cargado con todas las funcionalidades ‚úÖ");
          },
          onFormSubmit: async (formData) => {
            console.log("üì§ Enviando datos:", formData);
            updateDebugInfo("Procesando env√≠o de formulario... üì§");

            // Simular env√≠o
            await new Promise((resolve) => setTimeout(resolve, 2000));
            updateDebugInfo("¬°Formulario enviado exitosamente! ‚úÖ");
            return true;
          },
          onFieldChange: (field, value) => {
            console.log(`üîÑ Campo ${field.name} cambi√≥ a: ${value}`);
            updateDebugInfo(`Campo actualizado: ${field.name} = "${value}" üîÑ`);
          },
          onValidationError: (field, error) => {
            console.warn(`‚ùå Error validaci√≥n ${field}: ${error}`);
            updateDebugInfo(`Error validaci√≥n: ${field} - ${error} ‚ùå`);
          },
        },
      };

      // Inicializar el formulario
      document.addEventListener("DOMContentLoaded", function () {
        console.log("üöÄ Inicializando nuevo sistema de formularios...");

        // Crear instancia del FormManager usando la exportaci√≥n UMD
        const { FormManager } = FormModules;
        const form = new FormManager("#test-form", formConfig);

        // Inicializar el sistema
        form
          .initialize()
          .then(() => {
            console.log("‚úÖ Sistema de formularios inicializado correctamente");
            updateDebugInfo("Sistema inicializado correctamente ‚úÖ");

            // Configurar eventos espec√≠ficos del formulario de test
            setupFormEvents(form);
          })
          .catch((error) => {
            console.error("‚ùå Error inicializando formulario:", error);
            updateDebugInfo(`Error de inicializaci√≥n: ${error.message} ‚ùå`);
          });
      });

      // Configurar eventos espec√≠ficos del formulario
      function setupFormEvents(formManager) {
        // Mostrar/ocultar secci√≥n acad√©mica seg√∫n el tipo de asistente
        const typeAttendeeSelect = document.querySelector("select[name='type_attendee']");
        const academicFields = document.querySelectorAll(".academic-fields");

        typeAttendeeSelect.addEventListener("change", function () {
          if (this.value === "Aspirante") {
            academicFields.forEach((field) => (field.style.display = "flex"));
            updateDebugInfo("Campos acad√©micos activados para aspirante üìö");
          } else {
            academicFields.forEach((field) => (field.style.display = "none"));
            updateDebugInfo("Campos acad√©micos ocultados üìö");
          }
        });

        // Event listeners para debug info
        const form = document.querySelector("#test-form");

        form.addEventListener("change", function (e) {
          if (e.target.matches("input, select")) {
            updateDebugInfo(`Campo actualizado: ${e.target.name} = "${e.target.value}" üîÑ`);
          }
        });

        form.addEventListener("submit", function (e) {
          e.preventDefault();
          updateDebugInfo("Formulario enviado - Procesando... üì§");

          setTimeout(() => {
            updateDebugInfo("Formulario procesado exitosamente ‚úÖ");
          }, 2000);
        });
      }

      // Actualizar informaci√≥n de debug
      function updateDebugInfo(message) {
        const debugContent = document.getElementById("debug-content");
        const timestamp = new Date().toLocaleTimeString();
        debugContent.innerHTML = `[${timestamp}] ${message}`;
      }
    </script>
  </body>
</html>

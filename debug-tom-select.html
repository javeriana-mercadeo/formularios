<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Debug Tom Select - Formularios PUJ</title>
    <link rel="stylesheet" href="./build/form-modules-style.css" />
  </head>
  <body>
    <div class="form-modules">
      <h1>üêõ Debug Tom Select - Campo Colegio</h1>

      <form id="debug-form">
        <!-- Tipo de asistente -->
        <div class="field">
          <label for="type_attendee">Tipo de asistente:</label>
          <select name="type_attendee" id="type_attendee">
            <option value="">Selecciona una opci√≥n</option>
            <option value="Aspirante">Aspirante</option>
            <option value="Docente y/o psicoorientador">Docente y/o psicoorientador</option>
            <option value="Otro">Otro</option>
          </select>
        </div>

        <!-- Campo colegio (se muestra cuando type_attendee es Aspirante o Docente) -->
        <div class="field">
          <label for="school">Colegio:</label>
          <select name="school" id="school">
            <option value="">Selecciona tu colegio...</option>
          </select>
        </div>

        <button type="submit">Enviar</button>
      </form>

      <div
        id="debug-info"
        style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px"
      >
        <h3>üìä Debug Info:</h3>
        <div id="debug-messages"></div>
      </div>
    </div>

    <script src="./build/form-modules-script.js"></script>
    <script>
      // Interceptar console.log para mostrar en la p√°gina
      const debugDiv = document.getElementById("debug-messages");
      const originalConsoleLog = console.log;
      const originalConsoleInfo = console.info;
      const originalConsoleWarn = console.warn;
      const originalConsoleError = console.error;

      function addDebugMessage(level, message) {
        const div = document.createElement("div");
        div.style.marginBottom = "5px";
        div.style.fontSize = "12px";
        div.style.color =
          level === "error"
            ? "red"
            : level === "warn"
            ? "orange"
            : level === "info"
            ? "blue"
            : "black";
        div.textContent = `[${level.toUpperCase()}] ${message}`;
        debugDiv.appendChild(div);
        debugDiv.scrollTop = debugDiv.scrollHeight;
      }

      console.log = function (...args) {
        originalConsoleLog.apply(console, args);
        addDebugMessage("log", args.join(" "));
      };

      console.info = function (...args) {
        originalConsoleInfo.apply(console, args);
        addDebugMessage("info", args.join(" "));
      };

      console.warn = function (...args) {
        originalConsoleWarn.apply(console, args);
        addDebugMessage("warn", args.join(" "));
      };

      console.error = function (...args) {
        originalConsoleError.apply(console, args);
        addDebugMessage("error", args.join(" "));
      };

      // Configuraci√≥n de debug para los formularios (configuraci√≥n m√≠nima)
      const debugConfig = {
        eventName: "Debug Tom Select",
        environment: "development", 
        school: {
          schools: [
            "Colegio San Patricio",
            "Gimnasio Los Caobos",
            "Instituto Pedag√≥gico Nacional",
            "Colegio Nueva Granada",
            "Gimnasio Moderno",
          ],
        },
        // Desactivar campos ocultos que causan problemas
        disableHiddenFields: true
      };

      // Inicializar formulario
      (async () => {
      try {
        console.log("üöÄ Iniciando FormManager con configuraci√≥n de debug...");
        console.log("üì¶ FormModules disponible:", typeof FormModules);
        
        if (typeof FormModules === 'undefined') {
          throw new Error('FormModules no est√° definido. Verifica que el script se haya cargado correctamente.');
        }
        
        const formManager = new FormModules("#debug-form", debugConfig);
        console.log("‚úÖ FormManager creado, iniciando inicializaci√≥n...");
        
        await formManager.initialize();
        console.log("‚úÖ FormManager inicializado completamente");
      } catch (error) {
        console.error("‚ùå Error inicializando FormManager:", error);
        console.error("Stack trace:", error.stack);
      }
      })();
    </script>
  </body>
</html>

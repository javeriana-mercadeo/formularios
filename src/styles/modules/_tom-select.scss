// Tom Select - estilos base underlined compactos
.ts-wrapper {
  width: 100%;
  font-family: inherit;
  font-weight: var(--fm-font-weight-normal);

  .ts-control {
    width: 100%;
    padding: var(--fm-space-2) var(--fm-space-1);
    border: none;
    border-bottom: 1px solid var(--fm-input-border-color);
    border-radius: 0;
    background: transparent;
    color: var(--fm-input-text-color);
    font-size: var(--fm-font-size-sm);
    font-weight: var(--fm-font-weight-normal) !important;
    line-height: 1.5;
    box-sizing: border-box;
    cursor: pointer;
    outline: none;
    transition: border-bottom-color var(--fm-transition-normal);
    min-height: auto;

    .ts-control-input {
      font-family: inherit;
      font-size: var(--fm-font-size-sm);
      font-weight: var(--fm-font-weight-normal) !important;
      background: transparent;
      color: var(--fm-input-text-color);
      outline: none;
      border: none;
      line-height: var(--fm-line-height-normal);

      &::placeholder {
        color: var(--fm-input-placeholder-color);
        font-weight: var(--fm-font-weight-normal);
      }
    }

    .ts-input {
      font-family: inherit;
      font-size: var(--fm-font-size-sm);
      font-weight: var(--fm-font-weight-normal) !important;
      background: transparent;
      color: var(--fm-input-text-color);
      outline: none;
      border: none;
      line-height: var(--fm-line-height-normal);
    }

    .ts-item {
      font-family: inherit;
      font-size: var(--fm-font-size-sm);
      font-weight: var(--fm-font-weight-normal) !important;
      background-color: var(--fm-color-primary-50);
      color: var(--fm-color-primary-700);
      padding: var(--fm-space-1) var(--fm-space-2);
      border-radius: var(--fm-radius-base);
      margin-right: var(--fm-space-1);
    }
  }

  &.focus .ts-control,
  &.dropdown-active .ts-control {
    border-bottom-color: var(--fm-input-border-color-focus);
    border-bottom-width: 2px;
    outline: none;
  }

  &:hover:not(.focus):not(.dropdown-active) .ts-control {
    border-bottom-color: var(--fm-input-border-color-hover);
  }

  &.disabled .ts-control {
    color: var(--fm-text-disabled);
    border-bottom-color: var(--fm-border-subtle);
    cursor: not-allowed;
  }

  // Flecha consistente con selects nativos
  &.single .ts-control {
    &::after {
      content: '';
      position: absolute;
      right: var(--fm-space-1);
      top: 50%;
      transform: translateY(-50%);
      width: 1rem;
      height: 1rem;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: center;
      background-size: 1rem;
    }
  }

  &.dropdown-active.single .ts-control::after {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233e72b9' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M14 12l-4-4-4 4'/%3e%3c/svg%3e");
  }

  &.focus.single .ts-control::after {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233e72b9' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  }

  // Eliminar focus-visible outline
  &:focus-visible,
  .ts-control:focus-visible {
    outline: none;
  }
}

.ts-dropdown {
  border: 1px solid var(--fm-border-default);
  border-radius: var(--fm-radius-md);
  box-shadow: var(--fm-shadow-lg);
  background-color: var(--fm-surface-primary);
  border-top: none;
  font-family: inherit;
  margin-top: 2px;

  .ts-dropdown-content {
    max-height: 16rem;
    overflow-y: auto;

    .ts-option {
      padding: var(--fm-space-2) var(--fm-space-3);
      cursor: pointer;
      color: var(--fm-text-primary);
      font-family: inherit;
      font-size: var(--fm-font-size-select);
      font-weight: var(--fm-font-weight-normal) !important;
      line-height: var(--fm-line-height-normal);
      transition: background-color var(--fm-transition-fast);

      &:hover {
        background-color: var(--fm-surface-secondary);
      }

      &.active {
        background-color: var(--fm-interactive-primary);
        color: var(--fm-text-on-primary);
      }

      &.selected {
        background-color: var(--fm-color-primary-50);
        color: var(--fm-color-primary-700);
      }
    }
  }

  .ts-no-results {
    padding: var(--fm-space-3);
    text-align: center;
    color: var(--fm-text-muted);
    font-style: italic;
    font-size: var(--fm-font-size-sm);
    font-weight: var(--fm-font-weight-normal);
  }
}

@media (max-width: 768px) {
  .ts-wrapper .ts-control {
    padding: var(--fm-space-3) var(--fm-space-1);
    font-size: var(--fm-font-size-base);
  }

  .ts-dropdown .ts-dropdown-content .ts-option {
    padding: var(--fm-space-3);
    font-size: var(--fm-font-size-base);
  }
}

// Estados de validaci√≥n - consistentes con inputs nativos
.form-modules {
  .ts-wrapper.error .ts-control,
  .field.error .ts-wrapper .ts-control {
    border-bottom-color: var(--fm-input-border-color-error);

    &.focus {
      border-bottom-color: var(--fm-input-border-color-error);
      border-bottom-width: 2px;
    }
  }

  .ts-wrapper.validated .ts-control,
  .field.validated .ts-wrapper .ts-control {
    border-bottom-color: var(--fm-input-border-color-success);

    &.focus {
      border-bottom-color: var(--fm-input-border-color-success);
      border-bottom-width: 2px;
    }
  }

  .error-message {
    color: var(--fm-text-error);
    font-size: var(--fm-font-size-sm);
    font-weight: var(--fm-font-weight-normal);
    margin-top: var(--fm-space-1);
    font-family: inherit;
  }

  .loading {
    color: var(--fm-text-muted);
    font-size: var(--fm-font-size-sm);
    font-weight: var(--fm-font-weight-normal);
    padding: var(--fm-space-3);
    text-align: center;
    font-family: inherit;
    font-style: italic;
    border-top: 1px solid var(--fm-border-subtle);
  }

  .ts-dropdown-content {
    scrollbar-width: thin;
    scrollbar-color: var(--fm-scrollbar-thumb-color) var(--fm-scrollbar-track-color);

    &::-webkit-scrollbar {
      width: 6px;
    }

    &::-webkit-scrollbar-track {
      background: var(--fm-scrollbar-track-color);
    }

    &::-webkit-scrollbar-thumb {
      background: var(--fm-scrollbar-thumb-color);
      border-radius: var(--fm-radius-sm);
    }

    &::-webkit-scrollbar-thumb:hover {
      background: var(--fm-scrollbar-thumb-color-hover);
    }
  }
}
